"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8235],{25700:(t,e,s)=>{s.r(e),s.d(e,{default:()=>n});var a=s(5947),o=s.n(a);const i={metaInfo:{title:"Count Stock"},data:function(){return{isLoading:!0,SubmitProcessing:!1,serverParams:{columnFilters:{},sort:{field:"id",type:"desc"},page:1,perPage:10},selectedIds:[],totalRows:"",search:"",limit:"10",stocks:[],stock:{id:"",date:(new Date).toISOString().slice(0,10),warehouse_id:""}}},computed:{columns:function(){return[{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("warehouse"),field:"warehouse_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("file"),field:"file_stock",html:!0,tdClass:"text-left",thClass:"text-left",sortable:!1}]}},methods:{Selected_Warehouse:function(t){null===t&&(this.stock.warehouse_id="")},updateParams:function(t){this.serverParams=Object.assign({},this.serverParams,t)},onPageChange:function(t){var e=t.currentPage;this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Stocks(e))},onPerPageChange:function(t){var e=t.currentPerPage;this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Stocks(1))},selectionChanged:function(t){var e=this,s=t.selectedRows;this.selectedIds=[],s.forEach((function(t,s){e.selectedIds.push(t.id)}))},onSortChange:function(t){this.updateParams({sort:{type:t[0].type,field:t[0].field}}),this.Get_Stocks(this.serverParams.page)},onSearch:function(t){this.search=t.searchTerm,this.Get_Stocks(this.serverParams.page)},getValidationState:function(t){var e=t.dirty,s=t.validated,a=t.valid;return e||s?void 0===a?null:a:null},Submit_Count_Stock:function(){var t=this;this.$refs.Create_Count_stock.validate().then((function(e){e?t.Create_Count_stock():t.makeToast("danger",t.$t("Please_fill_the_form_correctly"),t.$t("Failed"))}))},makeToast:function(t,e,s){this.$root.$bvToast.toast(e,{title:s,variant:t,solid:!0})},New_count:function(){this.reset_Form(),this.$bvModal.show("New_count")},Get_Stocks:function(t){var e=this;o().start(),o().set(.1),axios.get("count_stock?page="+t+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((function(t){e.stocks=t.data.stocks,e.warehouses=t.data.warehouses,e.totalRows=t.data.totalRows,o().done(),e.isLoading=!1})).catch((function(t){o().done(),setTimeout((function(){e.isLoading=!1}),500)}))},Create_Count_stock:function(){var t=this;this.SubmitProcessing=!0,axios.post("store_count_stock",{date:this.stock.date,warehouse_id:this.stock.warehouse_id}).then((function(e){t.SubmitProcessing=!1,Fire.$emit("Event_Count"),t.makeToast("success",t.$t("Successfully_Generated_Count"),t.$t("Success"))})).catch((function(e){t.SubmitProcessing=!1,t.makeToast("danger",t.$t("InvalidData"),t.$t("Failed"))}))},reset_Form:function(){this.stock={id:"",date:(new Date).toISOString().slice(0,10),warehouse_id:""}}},created:function(){var t=this;this.Get_Stocks(1),Fire.$on("Event_Count",(function(){setTimeout((function(){t.Get_Stocks(t.serverParams.page),t.$bvModal.hide("New_count")}),500)}))}};const n=(0,s(14486).A)(i,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"main-content"},[e("breadcumb",{attrs:{page:t.$t("CountStock"),folder:t.$t("Products")}}),t._v(" "),t.isLoading?e("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):t._e(),t._v(" "),t.isLoading?t._e():e("b-card",{staticClass:"wrapper"},[e("vue-good-table",{attrs:{mode:"remote",columns:t.columns,totalRows:t.totalRows,rows:t.stocks,"search-options":{enabled:!0,placeholder:t.$t("Search_this_table")},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"table-hover tableOne vgt-table"},on:{"on-page-change":t.onPageChange,"on-per-page-change":t.onPerPageChange,"on-sort-change":t.onSortChange,"on-search":t.onSearch},scopedSlots:t._u([{key:"table-row",fn:function(s){return["file_stock"==s.column.field?e("span",[e("a",{attrs:{href:"/images/count_stock/"+s.row.file_stock}},[e("span",{staticClass:"ul-btn__text ml-1"},[t._v(" "+t._s(t.$t("Download")))])])]):t._e()]}}],null,!1,1441093153)},[e("div",{staticClass:"mt-2 mb-3",attrs:{slot:"table-actions"},slot:"table-actions"},[e("b-button",{staticClass:"btn-rounded",attrs:{variant:"btn btn-primary btn-icon m-1"},on:{click:function(e){return t.New_count()}}},[e("i",{staticClass:"i-Add"}),t._v("\n          "+t._s(t.$t("Count"))+"\n        ")])],1)])],1),t._v(" "),e("validation-observer",{ref:"Create_Count_stock"},[e("b-modal",{attrs:{"hide-footer":"",size:"md",id:"New_count",title:t.$t("CountStock")}},[e("b-form",{on:{submit:function(e){return e.preventDefault(),t.Submit_Count_Stock.apply(null,arguments)}}},[e("b-row",[e("b-col",{staticClass:"mb-3",attrs:{lg:"12",md:"12",sm:"12"}},[e("validation-provider",{attrs:{name:"date",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(s){return[e("b-form-group",{attrs:{label:t.$t("date")+" *"}},[e("b-form-input",{attrs:{state:t.getValidationState(s),"aria-describedby":"date-feedback",type:"date"},model:{value:t.stock.date,callback:function(e){t.$set(t.stock,"date",e)},expression:"stock.date"}}),t._v(" "),e("b-form-invalid-feedback",{attrs:{id:"date-feedback"}},[t._v(t._s(s.errors[0]))])],1)]}}])})],1),t._v(" "),e("b-col",{staticClass:"mb-3",attrs:{lg:"12",md:"12",sm:"12"}},[e("validation-provider",{attrs:{name:"warehouse",rules:{required:!0}},scopedSlots:t._u([{key:"default",fn:function(s){var a=s.valid,o=s.errors;return e("b-form-group",{attrs:{label:t.$t("warehouse")+" *"}},[e("v-select",{class:{"is-invalid":!!o.length},attrs:{state:!o[0]&&(!!a||null),reduce:function(t){return t.value},placeholder:t.$t("Choose_Warehouse"),options:t.warehouses.map((function(t){return{label:t.name,value:t.id}}))},on:{input:t.Selected_Warehouse},model:{value:t.stock.warehouse_id,callback:function(e){t.$set(t.stock,"warehouse_id",e)},expression:"stock.warehouse_id"}}),t._v(" "),e("b-form-invalid-feedback",[t._v(t._s(o[0]))])],1)}}])})],1),t._v(" "),e("b-col",{staticClass:"mt-3",attrs:{md:"12"}},[e("b-button",{attrs:{variant:"primary",type:"submit",disabled:t.SubmitProcessing}},[e("i",{staticClass:"i-Yes me-2 font-weight-bold"}),t._v(" "+t._s(t.$t("submit")))]),t._v(" "),t.SubmitProcessing?t._m(0):t._e()],1)],1)],1)],1)],1)],1)}),[function(){var t=this._self._c;return t("div",{staticClass:"typo__p"},[t("div",{staticClass:"spinner sm spinner-primary mt-3"})])}],!1,null,null,null).exports}}]);